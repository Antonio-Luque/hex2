<!DOCTYPE html>
<html>
<head>
<title>Hex2: Routine at 75D5</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../skoolkit-dark.css" />
</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html">Hex2</a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="30143.html">75BF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#30165">Map</a></td>
<td class="next">
Next: <a href="30237.html">761D</a>
</td>
</tr>
</table>
<div class="description">75D5: Bright and Animate Victory Path</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
Used by the routine at <a href="27833.html">Main_Match_End</a>.
</div>
<div class="paragraph">
Animate and highlight the hexagons included in shortest path when match ends.
</div>
</div>
<table class="input">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">B</td>
<td class="register-desc">Start position of the victory path</td>
</tr>
<tr>
<td class="register">HL</td>
<td class="register-desc"><a href="24576.html">CYAN_QUEUE_AREA</a> or <a href="25344.html">RED_QUEUE_AREA</a></td>
</tr>
</table>
</td>
</tr>
<tr>
<td class="asm-label">PathFinder_BrightPath</td>
<td class="address-2"><span id="30165"></span>75D5</td>
<td class="instruction">LD A,($619E)</td>
<td class="comment-1" rowspan="1">get <a href="24990.html">TOKEN_COLOR</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30168"></span>75D8</td>
<td class="instruction">PUSH AF</td>
<td class="comment-1" rowspan="1">save it at stack</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30169"></span>75D9</td>
<td class="instruction">ADD A,$40</td>
<td class="comment-1" rowspan="1">apply bright attribute</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30171"></span>75DB</td>
<td class="instruction">LD ($619E),A</td>
<td class="comment-1" rowspan="1">save new <a href="24990.html">TOKEN_COLOR</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30174"></span>75DE</td>
<td class="instruction">INC H</td>
<td class="comment-1" rowspan="2">move <span class="register">HL</span> to the start position of the victory path</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30175"></span>75DF</td>
<td class="instruction">LD L,B</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30176"></span>75E0</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-1" rowspan="1">set victory path length in <span class="register">C</span></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30177"></span>75E1</td>
<td class="instruction">JR <a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label">BrightPath_Neighbor</td>
<td class="address-2"><span id="30179"></span>75E3</td>
<td class="instruction">INC L</td>
<td class="comment-1" rowspan="1">move <span class="register">HL</span> to LEFT neighbor address</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30180"></span>75E4</td>
<td class="instruction">CP (HL)</td>
<td class="comment-1" rowspan="1">is it the same as victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30181"></span>75E5</td>
<td class="instruction">JR Z,<a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">yes, animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30183"></span>75E7</td>
<td class="instruction">DEC L</td>
<td class="comment-1" rowspan="2">move <span class="register">HL</span> to RIGHT neighbor address</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30184"></span>75E8</td>
<td class="instruction">DEC L</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30185"></span>75E9</td>
<td class="instruction">CP (HL)</td>
<td class="comment-1" rowspan="1">is it the same as victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30186"></span>75EA</td>
<td class="instruction">JR Z,<a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">yes, animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30188"></span>75EC</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="3">move <span class="register">HL</span> to UPPER-RIGHT neighbor address</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30189"></span>75ED</td>
<td class="instruction">SUB $08</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30191"></span>75EF</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30192"></span>75F0</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1">restore victory path length in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30193"></span>75F1</td>
<td class="instruction">CP (HL)</td>
<td class="comment-1" rowspan="1">is it the same as victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30194"></span>75F2</td>
<td class="instruction">JR Z,<a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">yes, animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30196"></span>75F4</td>
<td class="instruction">INC L</td>
<td class="comment-1" rowspan="1">move <span class="register">HL</span> to UPPER-LEFT neighbor address</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30197"></span>75F5</td>
<td class="instruction">CP (HL)</td>
<td class="comment-1" rowspan="1">is it the same as victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30198"></span>75F6</td>
<td class="instruction">JR Z,<a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">yes, animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30200"></span>75F8</td>
<td class="instruction">LD A,L</td>
<td class="comment-1" rowspan="3">move <span class="register">HL</span> to LOWER-RIGHT neighbor address</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30201"></span>75F9</td>
<td class="instruction">ADD A,$10</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30203"></span>75FB</td>
<td class="instruction">LD L,A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30204"></span>75FC</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1">restore victory path length in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30205"></span>75FD</td>
<td class="instruction">CP (HL)</td>
<td class="comment-1" rowspan="1">is it the same as victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30206"></span>75FE</td>
<td class="instruction">JR Z,<a href="30165.html#30209">BrightPath_Position</a></td>
<td class="comment-1" rowspan="1">yes, animate and highlight the hexagon position</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30208"></span>7600</td>
<td class="instruction">INC L</td>
<td class="comment-1" rowspan="1">move <span class="register">H</span> to LOWER-LEFT neighbor address</td>
</tr>
<tr>
<td class="asm-label">BrightPath_Position</td>
<td class="address-2"><span id="30209"></span>7601</td>
<td class="instruction">PUSH BC</td>
<td class="comment-1" rowspan="1">store victory path length</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30210"></span>7602</td>
<td class="instruction">PUSH HL</td>
<td class="comment-1" rowspan="1">store current position pointer</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30211"></span>7603</td>
<td class="instruction">CALL <a href="28033.html">Main_Board2Indexes</a></td>
<td class="comment-1" rowspan="1">convert a board position into a board indexes</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30214"></span>7606</td>
<td class="instruction">CALL <a href="28092.html">Draw_Token</a></td>
<td class="comment-1" rowspan="1">animate hexagon sprite on the screen</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30217"></span>7609</td>
<td class="instruction">LD IX,$64E7</td>
<td class="comment-1" rowspan="1"><span class="register">IX</span> points to <a href="25831.html">TOKEN_FX</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30221"></span>760D</td>
<td class="instruction">CALL <a href="30407.html">Sound_FX</a></td>
<td class="comment-1" rowspan="1">play sound effect</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30224"></span>7610</td>
<td class="instruction">POP HL</td>
<td class="comment-1" rowspan="1">restore current position pointer</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30225"></span>7611</td>
<td class="instruction">POP BC</td>
<td class="comment-1" rowspan="1">restore victory path length</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30226"></span>7612</td>
<td class="instruction">DEC C</td>
<td class="comment-1" rowspan="1">decrement victory path length</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30227"></span>7613</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1">set victory path length in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30228"></span>7614</td>
<td class="instruction">CP $03</td>
<td class="comment-1" rowspan="1">has reached victory path length?</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30230"></span>7616</td>
<td class="instruction">JR NZ,<a href="30165.html#30179">BrightPath_Neighbor</a></td>
<td class="comment-1" rowspan="1">repeat for each neighbor until reach victory length</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30232"></span>7618</td>
<td class="instruction">POP AF</td>
<td class="comment-1" rowspan="3">restore current <a href="24990.html">TOKEN_COLOR</a></td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30233"></span>7619</td>
<td class="instruction">LD ($619E),A</td>
</tr>
<tr>
<td class="asm-label"></td>
<td class="address-1"><span id="30236"></span>761C</td>
<td class="instruction">RET</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
Prev: <a href="30143.html">75BF</a>
</td>
<td class="up">Up: <a href="../maps/all.html#30165">Map</a></td>
<td class="next">
Next: <a href="30237.html">761D</a>
</td>
</tr>
</table>
<footer>
<div class="release"></div>
<div class="copyright">By Antonio Luque (2023).</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.10.</div>
</footer>
</body>
</html>